# Build stage - Red Hat .NET 8.0
FROM registry.access.redhat.com/ubi8/dotnet-80:8.0-13 AS build
WORKDIR /src

COPY ApiWalletLasVegasRaiders.csproj ./
RUN dotnet restore

COPY . ./
RUN dotnet publish -c Release -o /app/publish --no-restore

# Runtime stage
FROM registry.access.redhat.com/ubi8/dotnet-80:8.0-13
WORKDIR /app

COPY --from=build /app/publish .

ENV ASPNETCORE_URLS=http://*:8080
ENV ASPNETCORE_ENVIRONMENT=Production

EXPOSE 8080

USER 1001

ENTRYPOINT ["dotnet", "ApiWalletLasVegasRaiders.dll"]
